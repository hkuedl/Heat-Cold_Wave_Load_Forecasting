# Heat-Cold_Wave_Load_Forecasting

*In this work, we introduce a data-centric framework, ESDF, to address the critical challenge of electricity load forecasting during extreme heatwaves and coldwaves. The core of our approach is a three-stage pipeline that sequentially addresses data synthesis, representation purification, and final prediction to overcome the fundamental limitations of data scarcity and the fidelity gap in synthetic data.*

This repository includes codes for article "Electricity Load Forecasting Under Extreme Heat and Clod Waves" and a brief introduction of how to use them.

Authors: Nan Lu, Dalin Qin, Yangze Zhou, Yi Wang

## Overview
We propose an Extreme Synthesis-Disentanglement Forecasting (ESDF) framework to overcome the dual challenges of data scarcity and low-fidelity synthesis for load forecasting under heat and cold waves. The framework is designed as a three-stage pipeline that first strategically augments the training data with high-quality synthetic samples under extreme scenarios and then purifies the learned representations before making a final, resilient forecast. 

The overview of the proposed framework is presented in the following figure, comprising three critical components: (1) Extreme Classifier-Guided Diffusion Synthesis, (2) Fidelity-Aware Representation Disentanglement, and (3) Resilience-Enhanced Forecasting.

<p align="center">
<img src="github_figs/overall_framework_01.jpg" alt="overall framework" width="600" style="max-width: 100%; border: 1px solid #eee; border-radius: 5px;" />
</p>

## Data Preparation

Source data can be found in the following [OneDrive Link](https://connecthkuhk-my.sharepoint.com/:f:/g/personal/lnan_connect_hku_hk/ElbMtnE75hdEpmiEk_3uA-0BgV2nvZp92RA1GWOXn2CxNg?e=efORZP). Users can download the filefold "Data" from this link, and replace the filefold `Data` in this repository. Note that due to privacy concerns regarding certain data, we are only releasing two processed public datasets: Europe and PJM data. Each data file includes the hourly time index, electricity load, and temperature data.

## Requirements
Required libraries are provided in file `requirements.txt`. Please use "*pip install -r requirements.txt*" to ensure that codes can be executed.


## Experiments
Codes related to experiments are provided in filefold `forecasting_using_generated_samples.py`. 


Codes for **(1) Extreme Classifier-Guided Diffusion Synthesis** can be found in the following files: `Dataset_Loader_2D.py`, `diff_Model_2D. py`, `Models_2D.py`, `diff_training_2D.py`, and `generate_new_samples_2D.py`; The trained diffusion model parameters will be saved in filefold `Model_parameters`.


codes for **(2) Fidelity-Aware Representation Disentanglement** and **(3) Resilience-Enhanced Forecasting** can be found in the following files: `Forecasting_Models.py` and `Forecasting_model_training`. The experimental results (nMAE and nRMSE of the tested regions) will be saved in a csv file (e.g. "Europe.csv"). Best forecasting models on the validation set will be saved as pt files.

Users can simply run the file `Forecasting_model_training` to execute the experiments. The experiments include some baselines and ablation comparison methods (see in Forecasting_model_training): 

`results_visualization(model_type='ANN', 'LSTM', or 'CNN')`: simple baseline models

`results_visualization(model_type='ANN', 'LSTM', or 'CNN', data_aug=1)`: simple baseline models with naive data augmentation strategies

`results_visualization_nbeats()`: NBEATS

`results_visualization_impactnet()`: ImpactNet

`results_visualization_informer()`: Informer

`results_visualization_Autoformer()`: Autoformer

`results_visualization_dsn()`: Proposed (integrated with different backbones)

Here we present the performance of all comparison methods on the selected datasets in terms of normalized mean absolute error (nMAE) and normalized root mean square error (nRMSE).

## Visualization
Codes and data related to figures in our manuscript and supplementary are provided in filefold "Visualization". Here are some examples of figures generated by our codes.


